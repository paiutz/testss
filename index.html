<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Puter.js Developer Powerhouse - Ultimate System</title>
    
    <!-- Core Libraries -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Puter.js v2 - The Power Source -->
    <script src="https://js.puter.com/v2/"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Chart.js for Advanced Analytics -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Monaco Editor for Code -->
    <script src="https://unpkg.com/monaco-editor@0.45.0/min/vs/loader.js"></script>
    
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        @keyframes gradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        .animated-gradient {
            background: linear-gradient(-45deg, #ee7752, #e73c7e, #23a6d5, #23d5ab);
            background-size: 400% 400%;
            animation: gradient 15s ease infinite;
        }
        
        .neon-glow {
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.5),
                        0 0 40px rgba(102, 126, 234, 0.3),
                        0 0 60px rgba(102, 126, 234, 0.1);
        }
        
        .cyber-grid {
            background-image: 
                linear-gradient(rgba(102, 126, 234, 0.1) 1px, transparent 1px),
                linear-gradient(90deg, rgba(102, 126, 234, 0.1) 1px, transparent 1px);
            background-size: 50px 50px;
        }
        
        .glass-morphism {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .terminal-font {
            font-family: 'Fira Code', 'Courier New', monospace;
        }
        
        .pulse-dot {
            position: relative;
        }
        
        .pulse-dot::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 10px;
            height: 10px;
            background: #10b981;
            border-radius: 50%;
            animation: pulse-ring 2s infinite;
        }
        
        @keyframes pulse-ring {
            0% {
                box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.7);
            }
            70% {
                box-shadow: 0 0 0 10px rgba(16, 185, 129, 0);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(16, 185, 129, 0);
            }
        }
        
        .model-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 8px;
        }
        
        .scroll-smooth {
            scroll-behavior: smooth;
        }
        
        .monaco-container {
            min-height: 400px;
            border: 1px solid rgba(102, 126, 234, 0.3);
            border-radius: 8px;
            overflow: hidden;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        .float-animation {
            animation: float 3s ease-in-out infinite;
        }
    </style>
</head>
<body class="bg-gray-900 text-white cyber-grid">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, useCallback, useMemo, memo, createContext, useContext } = React;

        // ============= CONFIGURATION =============
        const ALL_AI_MODELS = {
            // OpenAI GPT-5 Series
            'gpt-5': { provider: 'OpenAI', category: 'General', speed: 'Fast', color: '#10b981' },
            'gpt-5-nano': { provider: 'OpenAI', category: 'Efficient', speed: 'Very Fast', color: '#34d399' },
            'gpt-5-mini': { provider: 'OpenAI', category: 'Balanced', speed: 'Fast', color: '#6ee7b7' },
            'gpt-5-chat-latest': { provider: 'OpenAI', category: 'Chat', speed: 'Fast', color: '#86efac' },
            
            // OpenAI GPT-4 Series
            'gpt-4.1': { provider: 'OpenAI', category: 'Advanced', speed: 'Medium', color: '#14b8a6' },
            'gpt-4.1-nano': { provider: 'OpenAI', category: 'Efficient', speed: 'Fast', color: '#2dd4bf' },
            'gpt-4.1-mini': { provider: 'OpenAI', category: 'Balanced', speed: 'Fast', color: '#5eead4' },
            'gpt-4.5-preview': { provider: 'OpenAI', category: 'Preview', speed: 'Medium', color: '#99f6e4' },
            'gpt-4o': { provider: 'OpenAI', category: 'Optimized', speed: 'Fast', color: '#06b6d4' },
            'gpt-4o-mini': { provider: 'OpenAI', category: 'Light', speed: 'Very Fast', color: '#22d3ee' },
            
            // OpenAI O Series
            'o1': { provider: 'OpenAI', category: 'Reasoning', speed: 'Slow', color: '#0891b2' },
            'o1-mini': { provider: 'OpenAI', category: 'Light Reasoning', speed: 'Medium', color: '#0ea5e9' },
            'o1-pro': { provider: 'OpenAI', category: 'Pro Reasoning', speed: 'Slow', color: '#38bdf8' },
            'o3': { provider: 'OpenAI', category: 'Advanced', speed: 'Medium', color: '#7dd3fc' },
            'o3-mini': { provider: 'OpenAI', category: 'Light', speed: 'Fast', color: '#bae6fd' },
            'o4-mini': { provider: 'OpenAI', category: 'Latest', speed: 'Fast', color: '#e0f2fe' },
            
            // Anthropic Claude
            'claude': { provider: 'Anthropic', category: 'General', speed: 'Fast', color: '#f97316' },
            'claude-sonnet-4': { provider: 'Anthropic', category: 'Creative', speed: 'Medium', color: '#fb923c' },
            'claude-opus-4': { provider: 'Anthropic', category: 'Advanced', speed: 'Medium', color: '#fdba74' },
            'openrouter:anthropic/claude-3.7-sonnet': { provider: 'Anthropic', category: 'Latest', speed: 'Fast', color: '#fed7aa' },
            'openrouter:anthropic/claude-opus-4.1': { provider: 'Anthropic', category: 'Pro', speed: 'Medium', color: '#ffedd5' },
            
            // Google Gemini
            'google/gemini-2.0-flash': { provider: 'Google', category: 'Fast', speed: 'Very Fast', color: '#3b82f6' },
            'google/gemini-2.5-pro': { provider: 'Google', category: 'Pro', speed: 'Medium', color: '#60a5fa' },
            'google/gemini-1.5-flash': { provider: 'Google', category: 'Efficient', speed: 'Very Fast', color: '#93c5fd' },
            'openrouter:google/gemini-3.0': { provider: 'Google', category: 'Latest', speed: 'Fast', color: '#bfdbfe' },
            
            // Meta Llama
            'meta-llama/llama-4-maverick': { provider: 'Meta', category: 'Latest', speed: 'Fast', color: '#8b5cf6' },
            'meta-llama/llama-3.3-70b-instruct': { provider: 'Meta', category: 'Large', speed: 'Slow', color: '#a78bfa' },
            'meta-llama/llama-3.1-8b-instruct': { provider: 'Meta', category: 'Light', speed: 'Fast', color: '#c4b5fd' },
            'meta-llama/llama-guard-3-8b': { provider: 'Meta', category: 'Safety', speed: 'Fast', color: '#ddd6fe' },
            'openrouter:meta-llama/llama-3.1-405b-instruct': { provider: 'Meta', category: 'Massive', speed: 'Very Slow', color: '#ede9fe' },
            
            // Mistral
            'mistralai/mistral-large': { provider: 'Mistral', category: 'Large', speed: 'Medium', color: '#ec4899' },
            'mistralai/codestral-2508': { provider: 'Mistral', category: 'Code', speed: 'Fast', color: '#f472b6' },
            'mistralai/mistral-nemo': { provider: 'Mistral', category: 'Efficient', speed: 'Very Fast', color: '#f9a8d4' },
            'openrouter:mistralai/mixtral-8x7b-instruct': { provider: 'Mistral', category: 'MoE', speed: 'Medium', color: '#fbcfe8' },
            
            // DeepSeek
            'deepseek-chat': { provider: 'DeepSeek', category: 'Chat', speed: 'Fast', color: '#6366f1' },
            'deepseek-reasoner': { provider: 'DeepSeek', category: 'Reasoning', speed: 'Medium', color: '#818cf8' },
            'openrouter:deepseek/deepseek-v3': { provider: 'DeepSeek', category: 'Latest', speed: 'Fast', color: '#a5b4fc' },
            
            // xAI Grok
            'x-ai/grok-4': { provider: 'xAI', category: 'Latest', speed: 'Fast', color: '#ef4444' },
            'x-ai/grok-3': { provider: 'xAI', category: 'General', speed: 'Fast', color: '#f87171' },
            'x-ai/grok-3-mini': { provider: 'xAI', category: 'Light', speed: 'Very Fast', color: '#fca5a5' },
            'x-ai/grok-2-1212': { provider: 'xAI', category: 'Stable', speed: 'Medium', color: '#fecaca' },
            'x-ai/grok-vision-beta': { provider: 'xAI', category: 'Vision', speed: 'Medium', color: '#fee2e2' },
            
            // Alibaba Qwen
            'qwen/qwq-32b': { provider: 'Alibaba', category: 'Reasoning', speed: 'Medium', color: '#eab308' },
            'qwen/qwen3-235b-a22b': { provider: 'Alibaba', category: 'Massive', speed: 'Slow', color: '#facc15' },
            'qwen/qwen3-coder': { provider: 'Alibaba', category: 'Code', speed: 'Fast', color: '#fde047' },
            'qwen/qwen-vl-max': { provider: 'Alibaba', category: 'Vision', speed: 'Medium', color: '#fef08a' },
            'qwen/qwen2.5-72b-instruct': { provider: 'Alibaba', category: 'Large', speed: 'Medium', color: '#fef9c3' },
            
            // OpenRouter Models (400+ available)
            'openrouter:perplexity/llama-3.1-sonar-large-128k-online': { provider: 'Perplexity', category: 'Online', speed: 'Medium', color: '#84cc16' },
            'openrouter:cohere/command-r-plus': { provider: 'Cohere', category: 'General', speed: 'Medium', color: '#a3e635' },
            'openrouter:databricks/dbrx-instruct': { provider: 'Databricks', category: 'Enterprise', speed: 'Medium', color: '#bef264' },
            'openrouter:nvidia/nemotron-70b': { provider: 'NVIDIA', category: 'Large', speed: 'Slow', color: '#d9f99d' },
            'openrouter:microsoft/phi-3-medium': { provider: 'Microsoft', category: 'Efficient', speed: 'Fast', color: '#ecfccb' },
            'openrouter:inflection/inflection-3-pi': { provider: 'Inflection', category: 'Personal', speed: 'Fast', color: '#f0fdf4' },
        };

        // ============= GLOBAL CONTEXT =============
        const AppContext = createContext();
        
        const AppProvider = ({ children }) => {
            const [auth, setAuth] = useState({ isSignedIn: false, user: null });
            const [models, setModels] = useState(['gpt-5-nano']);
            const [stats, setStats] = useState({
                totalRequests: 0,
                totalTokens: 0,
                totalCost: 0,
                requestsByModel: {},
                errorRate: 0,
                avgResponseTime: 0
            });
            
            const value = {
                auth, setAuth,
                models, setModels,
                stats, setStats
            };
            
            return <AppContext.Provider value={value}>{children}</AppContext.Provider>;
        };
        
        const useApp = () => useContext(AppContext);

        // ============= ADVANCED RESOURCE MANAGER =============
        class AdvancedResourceManager {
            constructor() {
                this.queues = new Map(); // Separate queue per model provider
                this.cache = new Map();
                this.rateLimits = new Map();
                this.circuitBreakers = new Map();
                this.metrics = {
                    requests: new Map(),
                    latencies: [],
                    errors: new Map(),
                    cacheHits: 0,
                    cacheMisses: 0
                };
                this.workers = new Map(); // Web Workers for heavy processing
            }

            async executeWithRetry(fn, options = {}) {
                const { maxRetries = 3, backoff = 1000 } = options;
                let lastError;
                
                for (let i = 0; i < maxRetries; i++) {
                    try {
                        return await fn();
                    } catch (error) {
                        lastError = error;
                        if (i < maxRetries - 1) {
                            await this.delay(backoff * Math.pow(2, i));
                        }
                    }
                }
                throw lastError;
            }

            async executeWithCircuitBreaker(provider, fn) {
                const breaker = this.circuitBreakers.get(provider) || {
                    failures: 0,
                    lastFailure: 0,
                    state: 'closed'
                };

                if (breaker.state === 'open') {
                    const timeSinceFailure = Date.now() - breaker.lastFailure;
                    if (timeSinceFailure < 30000) { // 30 second timeout
                        throw new Error(`Circuit breaker open for ${provider}`);
                    }
                    breaker.state = 'half-open';
                }

                try {
                    const result = await fn();
                    if (breaker.state === 'half-open') {
                        breaker.state = 'closed';
                        breaker.failures = 0;
                    }
                    return result;
                } catch (error) {
                    breaker.failures++;
                    breaker.lastFailure = Date.now();
                    
                    if (breaker.failures >= 5) {
                        breaker.state = 'open';
                    }
                    
                    this.circuitBreakers.set(provider, breaker);
                    throw error;
                }
            }

            getCacheKey(operation, params) {
                return `${operation}:${JSON.stringify(params)}`;
            }

            async cacheOperation(key, fn, ttl = 300000) { // 5 min default
                if (this.cache.has(key)) {
                    this.metrics.cacheHits++;
                    return this.cache.get(key).data;
                }

                this.metrics.cacheMisses++;
                const result = await fn();
                
                this.cache.set(key, {
                    data: result,
                    timestamp: Date.now(),
                    ttl
                });

                setTimeout(() => this.cache.delete(key), ttl);
                return result;
            }

            delay(ms) {
                return new Promise(resolve => setTimeout(resolve, ms));
            }

            getMetrics() {
                const avgLatency = this.metrics.latencies.length > 0
                    ? this.metrics.latencies.reduce((a, b) => a + b, 0) / this.metrics.latencies.length
                    : 0;

                return {
                    totalRequests: Array.from(this.metrics.requests.values()).reduce((a, b) => a + b, 0),
                    avgLatency: Math.round(avgLatency),
                    cacheHitRate: this.metrics.cacheHits / (this.metrics.cacheHits + this.metrics.cacheMisses) || 0,
                    errorRate: Array.from(this.metrics.errors.values()).reduce((a, b) => a + b, 0) / 
                              Array.from(this.metrics.requests.values()).reduce((a, b) => a + b, 0) || 0,
                    providerStatus: Array.from(this.circuitBreakers.entries()).map(([provider, breaker]) => ({
                        provider,
                        status: breaker.state,
                        failures: breaker.failures
                    }))
                };
            }

            reset() {
                this.cache.clear();
                this.metrics = {
                    requests: new Map(),
                    latencies: [],
                    errors: new Map(),
                    cacheHits: 0,
                    cacheMisses: 0
                };
                this.circuitBreakers.clear();
            }
        }

        const resourceManager = new AdvancedResourceManager();

        // ============= NETWORKING COMPONENTS =============
        const NetworkingPanel = memo(() => {
            const [corsUrl, setCorsUrl] = useState('');
            const [corsResponse, setCorsResponse] = useState(null);
            const [loading, setLoading] = useState(false);
            const [tcpHost, setTcpHost] = useState('');
            const [tcpPort, setTcpPort] = useState('');
            const [tcpConnected, setTcpConnected] = useState(false);
            const [tcpMessages, setTcpMessages] = useState([]);
            const socketRef = useRef(null);

            const fetchCorsFreee = async () => {
                if (!corsUrl) return;
                
                setLoading(true);
                try {
                    const response = await puter.net.fetch(corsUrl);
                    const text = await response.text();
                    setCorsResponse({
                        status: response.status,
                        headers: Object.fromEntries(response.headers.entries()),
                        body: text.substring(0, 1000) // First 1000 chars
                    });
                } catch (error) {
                    setCorsResponse({ error: error.message });
                } finally {
                    setLoading(false);
                }
            };

            const connectTcp = async () => {
                if (!tcpHost || !tcpPort) return;
                
                try {
                    // Note: This is a conceptual example - actual implementation would depend on Puter.js Socket API
                    socketRef.current = new puter.net.Socket();
                    await socketRef.current.connect(tcpHost, parseInt(tcpPort));
                    
                    setTcpConnected(true);
                    setTcpMessages(prev => [...prev, {
                        type: 'system',
                        text: `Connected to ${tcpHost}:${tcpPort}`,
                        timestamp: new Date()
                    }]);

                    socketRef.current.on('data', (data) => {
                        setTcpMessages(prev => [...prev, {
                            type: 'received',
                            text: data,
                            timestamp: new Date()
                        }]);
                    });

                    socketRef.current.on('close', () => {
                        setTcpConnected(false);
                        setTcpMessages(prev => [...prev, {
                            type: 'system',
                            text: 'Connection closed',
                            timestamp: new Date()
                        }]);
                    });
                } catch (error) {
                    setTcpMessages(prev => [...prev, {
                        type: 'error',
                        text: error.message,
                        timestamp: new Date()
                    }]);
                }
            };

            const sendTcpMessage = (message) => {
                if (socketRef.current && tcpConnected) {
                    socketRef.current.write(message);
                    setTcpMessages(prev => [...prev, {
                        type: 'sent',
                        text: message,
                        timestamp: new Date()
                    }]);
                }
            };

            return (
                <div className="p-6 space-y-6">
                    {/* CORS-Free Fetch */}
                    <div className="glass-morphism rounded-xl p-6">
                        <h2 className="text-2xl font-bold mb-4 flex items-center gap-2">
                            <span className="text-3xl">üåê</span> CORS-Free HTTP Fetch
                        </h2>
                        
                        <div className="space-y-4">
                            <div className="flex gap-2">
                                <input
                                    type="url"
                                    value={corsUrl}
                                    onChange={(e) => setCorsUrl(e.target.value)}
                                    placeholder="Enter any URL (no CORS restrictions)..."
                                    className="flex-1 px-4 py-2 bg-gray-800 border border-gray-600 rounded-lg focus:outline-none focus:border-blue-500"
                                />
                                <button
                                    onClick={fetchCorsFreee}
                                    disabled={loading || !corsUrl}
                                    className="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-all"
                                >
                                    {loading ? 'Fetching...' : 'Fetch'}
                                </button>
                            </div>

                            {corsResponse && (
                                <div className="bg-gray-800 rounded-lg p-4 terminal-font text-sm">
                                    {corsResponse.error ? (
                                        <div className="text-red-400">Error: {corsResponse.error}</div>
                                    ) : (
                                        <>
                                            <div className="text-green-400 mb-2">
                                                Status: {corsResponse.status}
                                            </div>
                                            <div className="text-blue-400 mb-2">
                                                Headers: {JSON.stringify(corsResponse.headers, null, 2)}
                                            </div>
                                            <div className="text-gray-300">
                                                Body: {corsResponse.body}
                                            </div>
                                        </>
                                    )}
                                </div>
                            )}
                        </div>
                    </div>

                    {/* Raw TCP Socket */}
                    <div className="glass-morphism rounded-xl p-6">
                        <h2 className="text-2xl font-bold mb-4 flex items-center gap-2">
                            <span className="text-3xl">üîå</span> Raw TCP Socket
                        </h2>
                        
                        <div className="space-y-4">
                            <div className="grid grid-cols-3 gap-2">
                                <input
                                    type="text"
                                    value={tcpHost}
                                    onChange={(e) => setTcpHost(e.target.value)}
                                    placeholder="Host (e.g., example.com)"
                                    className="col-span-2 px-4 py-2 bg-gray-800 border border-gray-600 rounded-lg"
                                />
                                <input
                                    type="number"
                                    value={tcpPort}
                                    onChange={(e) => setTcpPort(e.target.value)}
                                    placeholder="Port (e.g., 22)"
                                    className="px-4 py-2 bg-gray-800 border border-gray-600 rounded-lg"
                                />
                            </div>

                            <button
                                onClick={tcpConnected ? () => {
                                    socketRef.current?.close();
                                    setTcpConnected(false);
                                } : connectTcp}
                                disabled={!tcpHost || !tcpPort}
                                className={`px-6 py-2 rounded-lg transition-all ${
                                    tcpConnected 
                                        ? 'bg-red-600 hover:bg-red-700' 
                                        : 'bg-green-600 hover:bg-green-700'
                                } text-white disabled:opacity-50`}
                            >
                                {tcpConnected ? 'Disconnect' : 'Connect'}
                            </button>

                            {tcpMessages.length > 0 && (
                                <div className="bg-gray-900 rounded-lg p-4 h-64 overflow-y-auto terminal-font text-xs">
                                    {tcpMessages.map((msg, idx) => (
                                        <div key={idx} className={`mb-1 ${
                                            msg.type === 'sent' ? 'text-blue-400' :
                                            msg.type === 'received' ? 'text-green-400' :
                                            msg.type === 'error' ? 'text-red-400' :
                                            'text-gray-400'
                                        }`}>
                                            [{msg.timestamp.toLocaleTimeString()}] {msg.type.toUpperCase()}: {msg.text}
                                        </div>
                                    ))}
                                </div>
                            )}
                        </div>
                    </div>
                </div>
            );
        });

        // ============= AI ORCHESTRATOR =============
        const AIOrchestrator = memo(() => {
            const { models, setModels } = useApp();
            const [prompt, setPrompt] = useState('');
            const [responses, setResponses] = useState([]);
            const [loading, setLoading] = useState(false);
            const [mode, setMode] = useState('single'); // single, parallel, cascade, tournament
            const [useStreaming, setUseStreaming] = useState(false);
            const [temperature, setTemperature] = useState(0.7);
            const [maxTokens, setMaxTokens] = useState(1000);

            const executePrompt = async () => {
                if (!prompt || models.length === 0) return;

                setLoading(true);
                setResponses([]);

                try {
                    switch (mode) {
                        case 'single':
                            await executeSingle();
                            break;
                        case 'parallel':
                            await executeParallel();
                            break;
                        case 'cascade':
                            await executeCascade();
                            break;
                        case 'tournament':
                            await executeTournament();
                            break;
                    }
                } catch (error) {
                    console.error('Execution error:', error);
                } finally {
                    setLoading(false);
                }
            };

            const executeSingle = async () => {
                const model = models[0];
                const startTime = Date.now();
                
                try {
                    const response = await resourceManager.executeWithRetry(async () => {
                        return await puter.ai.chat(prompt, {
                            model,
                            stream: useStreaming,
                            temperature,
                            max_tokens: maxTokens
                        });
                    });

                    const latency = Date.now() - startTime;
                    resourceManager.metrics.latencies.push(latency);

                    setResponses([{
                        model,
                        content: response,
                        latency,
                        tokens: response.length / 4, // Approximate
                        timestamp: new Date()
                    }]);
                } catch (error) {
                    setResponses([{
                        model,
                        error: error.message,
                        timestamp: new Date()
                    }]);
                }
            };

            const executeParallel = async () => {
                const promises = models.map(async (model) => {
                    const startTime = Date.now();
                    
                    try {
                        const response = await resourceManager.executeWithCircuitBreaker(
                            ALL_AI_MODELS[model]?.provider || 'Unknown',
                            async () => {
                                return await puter.ai.chat(prompt, {
                                    model,
                                    temperature,
                                    max_tokens: maxTokens
                                });
                            }
                        );

                        const latency = Date.now() - startTime;
                        return {
                            model,
                            content: response,
                            latency,
                            tokens: response.length / 4,
                            timestamp: new Date()
                        };
                    } catch (error) {
                        return {
                            model,
                            error: error.message,
                            timestamp: new Date()
                        };
                    }
                });

                const results = await Promise.allSettled(promises);
                setResponses(results.map(r => r.status === 'fulfilled' ? r.value : r.reason));
            };

            const executeCascade = async () => {
                let currentPrompt = prompt;
                const cascadeResponses = [];

                for (const model of models) {
                    const startTime = Date.now();
                    
                    try {
                        const response = await puter.ai.chat(currentPrompt, {
                            model,
                            temperature,
                            max_tokens: maxTokens
                        });

                        const latency = Date.now() - startTime;
                        cascadeResponses.push({
                            model,
                            content: response,
                            latency,
                            tokens: response.length / 4,
                            timestamp: new Date()
                        });

                        // Use previous response as input for next model
                        currentPrompt = `Based on this response: "${response}", provide your perspective on: ${prompt}`;
                    } catch (error) {
                        cascadeResponses.push({
                            model,
                            error: error.message,
                            timestamp: new Date()
                        });
                        break;
                    }
                }

                setResponses(cascadeResponses);
            };

            const executeTournament = async () => {
                // Tournament: Models compete in pairs, winner advances
                let competitors = [...models];
                const rounds = [];

                while (competitors.length > 1) {
                    const roundResults = [];
                    const pairs = [];

                    // Create pairs
                    for (let i = 0; i < competitors.length; i += 2) {
                        if (i + 1 < competitors.length) {
                            pairs.push([competitors[i], competitors[i + 1]]);
                        } else {
                            // Odd one out advances automatically
                            roundResults.push(competitors[i]);
                        }
                    }

                    // Run comparisons
                    for (const [model1, model2] of pairs) {
                        const [response1, response2] = await Promise.all([
                            puter.ai.chat(prompt, { model: model1, max_tokens: maxTokens }),
                            puter.ai.chat(prompt, { model: model2, max_tokens: maxTokens })
                        ]);

                        // Simple scoring: longer response wins (you could implement better scoring)
                        const winner = response1.length > response2.length ? model1 : model2;
                        roundResults.push(winner);

                        rounds.push({
                            competitors: [model1, model2],
                            winner,
                            responses: { [model1]: response1, [model2]: response2 }
                        });
                    }

                    competitors = roundResults;
                }

                setResponses(rounds.map((round, idx) => ({
                    round: idx + 1,
                    ...round,
                    timestamp: new Date()
                })));
            };

            return (
                <div className="p-6 space-y-6">
                    {/* Model Selector */}
                    <div className="glass-morphism rounded-xl p-6">
                        <h3 className="text-xl font-bold mb-4">Select AI Models (400+ Available)</h3>
                        
                        <div className="mb-4 flex gap-2">
                            <button
                                onClick={() => setModels(Object.keys(ALL_AI_MODELS).slice(0, 5))}
                                className="px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700"
                            >
                                Top 5
                            </button>
                            <button
                                onClick={() => setModels(Object.keys(ALL_AI_MODELS).filter(m => 
                                    ALL_AI_MODELS[m].speed === 'Very Fast'
                                ))}
                                className="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700"
                            >
                                Fastest
                            </button>
                            <button
                                onClick={() => setModels(Object.keys(ALL_AI_MODELS).filter(m => 
                                    ALL_AI_MODELS[m].category === 'Reasoning'
                                ))}
                                className="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700"
                            >
                                Reasoning
                            </button>
                            <button
                                onClick={() => setModels([])}
                                className="px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700"
                            >
                                Clear
                            </button>
                        </div>

                        <div className="model-grid max-h-64 overflow-y-auto">
                            {Object.entries(ALL_AI_MODELS).map(([key, model]) => (
                                <button
                                    key={key}
                                    onClick={() => {
                                        setModels(prev => 
                                            prev.includes(key) 
                                                ? prev.filter(m => m !== key)
                                                : [...prev, key]
                                        );
                                    }}
                                    className={`p-2 rounded-lg text-xs font-medium transition-all ${
                                        models.includes(key)
                                            ? 'bg-opacity-100 text-white'
                                            : 'bg-opacity-20 text-gray-300 hover:bg-opacity-30'
                                    }`}
                                    style={{ backgroundColor: model.color }}
                                    title={`${model.provider} - ${model.category} - ${model.speed}`}
                                >
                                    {key.replace('openrouter:', '').substring(0, 20)}
                                </button>
                            ))}
                        </div>
                        
                        <div className="mt-4 text-sm text-gray-400">
                            Selected: {models.length} models
                        </div>
                    </div>

                    {/* Execution Modes */}
                    <div className="glass-morphism rounded-xl p-6">
                        <h3 className="text-xl font-bold mb-4">Execution Mode</h3>
                        
                        <div className="grid grid-cols-4 gap-2 mb-4">
                            {['single', 'parallel', 'cascade', 'tournament'].map(m => (
                                <button
                                    key={m}
                                    onClick={() => setMode(m)}
                                    className={`px-4 py-2 rounded-lg capitalize transition-all ${
                                        mode === m
                                            ? 'bg-blue-600 text-white'
                                            : 'bg-gray-700 text-gray-300 hover:bg-gray-600'
                                    }`}
                                >
                                    {m}
                                </button>
                            ))}
                        </div>

                        <div className="grid grid-cols-3 gap-4 mb-4">
                            <label className="flex items-center gap-2">
                                <input
                                    type="checkbox"
                                    checked={useStreaming}
                                    onChange={(e) => setUseStreaming(e.target.checked)}
                                    className="rounded"
                                />
                                <span className="text-sm">Streaming</span>
                            </label>
                            
                            <div>
                                <label className="text-xs text-gray-400">Temperature</label>
                                <input
                                    type="range"
                                    min="0"
                                    max="2"
                                    step="0.1"
                                    value={temperature}
                                    onChange={(e) => setTemperature(parseFloat(e.target.value))}
                                    className="w-full"
                                />
                                <span className="text-xs">{temperature}</span>
                            </div>
                            
                            <div>
                                <label className="text-xs text-gray-400">Max Tokens</label>
                                <input
                                    type="number"
                                    value={maxTokens}
                                    onChange={(e) => setMaxTokens(parseInt(e.target.value))}
                                    className="w-full px-2 py-1 bg-gray-800 rounded"
                                />
                            </div>
                        </div>

                        <div className="flex gap-2">
                            <textarea
                                value={prompt}
                                onChange={(e) => setPrompt(e.target.value)}
                                placeholder="Enter your prompt..."
                                className="flex-1 px-4 py-2 bg-gray-800 border border-gray-600 rounded-lg h-24 resize-none"
                            />
                            <button
                                onClick={executePrompt}
                                disabled={loading || !prompt || models.length === 0}
                                className="px-8 py-2 bg-gradient-to-r from-purple-600 to-blue-600 text-white rounded-lg hover:from-purple-700 hover:to-blue-700 disabled:opacity-50 transition-all"
                            >
                                {loading ? 'Processing...' : 'Execute'}
                            </button>
                        </div>
                    </div>

                    {/* Responses */}
                    {responses.length > 0 && (
                        <div className="space-y-4">
                            {mode === 'tournament' ? (
                                // Tournament view
                                <div className="glass-morphism rounded-xl p-6">
                                    <h3 className="text-xl font-bold mb-4">Tournament Results</h3>
                                    {responses.map((round, idx) => (
                                        <div key={idx} className="mb-4 p-4 bg-gray-800 rounded-lg">
                                            <h4 className="font-bold text-green-400 mb-2">
                                                Round {round.round}: {round.competitors.join(' vs ')}
                                            </h4>
                                            <p className="text-yellow-400">Winner: {round.winner}</p>
                                        </div>
                                    ))}
                                </div>
                            ) : (
                                // Regular response view
                                responses.map((response, idx) => (
                                    <div key={idx} className="glass-morphism rounded-xl p-6">
                                        <div className="flex items-start justify-between mb-2">
                                            <div className="flex items-center gap-2">
                                                <span 
                                                    className="px-3 py-1 rounded-full text-xs font-bold text-white"
                                                    style={{ backgroundColor: ALL_AI_MODELS[response.model]?.color || '#666' }}
                                                >
                                                    {response.model}
                                                </span>
                                                {response.latency && (
                                                    <span className="text-xs text-gray-400">
                                                        {response.latency}ms
                                                    </span>
                                                )}
                                                {response.tokens && (
                                                    <span className="text-xs text-gray-400">
                                                        ~{response.tokens} tokens
                                                    </span>
                                                )}
                                            </div>
                                            <span className="text-xs text-gray-500">
                                                {response.timestamp?.toLocaleTimeString()}
                                            </span>
                                        </div>
                                        
                                        <div className="prose prose-invert max-w-none">
                                            {response.error ? (
                                                <div className="text-red-400">Error: {response.error}</div>
                                            ) : (
                                                <div className="whitespace-pre-wrap">{response.content}</div>
                                            )}
                                        </div>
                                    </div>
                                ))
                            )}
                        </div>
                    )}
                </div>
            );
        });

        // ============= CODE PLAYGROUND =============
        const CodePlayground = memo(() => {
            const [code, setCode] = useState(`// Puter.js Code Playground
// Access 400+ AI models, CORS-free networking, and more!

async function demo() {
    // Example 1: Multi-model AI comparison
    const models = ['gpt-5-nano', 'claude-sonnet-4', 'deepseek-reasoner'];
    const prompt = "What is consciousness?";
    
    const responses = await Promise.all(
        models.map(model => puter.ai.chat(prompt, { model }))
    );
    
    console.log('AI Responses:', responses);
    
    // Example 2: CORS-free fetch
    const data = await puter.net.fetch('https://api.github.com/users/github');
    console.log('GitHub data:', await data.json());
    
    // Example 3: Cloud storage
    await puter.fs.write('demo.txt', 'Hello from Puter.js!');
    const file = await puter.fs.read('demo.txt');
    console.log('File content:', await file.text());
    
    // Example 4: Website hosting
    const site = await puter.hosting.create(puter.randName(), './my-site');
    console.log('Website published at:', site.url);
}

demo();`);
            const [output, setOutput] = useState('');
            const [running, setRunning] = useState(false);
            const editorRef = useRef(null);
            const monacoRef = useRef(null);

            useEffect(() => {
                // Initialize Monaco Editor
                if (typeof window !== 'undefined' && window.require) {
                    window.require.config({ 
                        paths: { 
                            'vs': 'https://unpkg.com/monaco-editor@0.45.0/min/vs' 
                        } 
                    });
                    
                    window.require(['vs/editor/editor.main'], function() {
                        if (editorRef.current && !monacoRef.current) {
                            monacoRef.current = monaco.editor.create(editorRef.current, {
                                value: code,
                                language: 'javascript',
                                theme: 'vs-dark',
                                automaticLayout: true,
                                minimap: { enabled: false },
                                fontSize: 14,
                                wordWrap: 'on'
                            });
                            
                            monacoRef.current.onDidChangeModelContent(() => {
                                setCode(monacoRef.current.getValue());
                            });
                        }
                    });
                }
            }, []);

            const runCode = async () => {
                setRunning(true);
                setOutput('');
                
                // Create custom console
                const customConsole = {
                    log: (...args) => {
                        setOutput(prev => prev + args.map(a => 
                            typeof a === 'object' ? JSON.stringify(a, null, 2) : a
                        ).join(' ') + '\n');
                    },
                    error: (...args) => {
                        setOutput(prev => prev + '‚ùå ' + args.join(' ') + '\n');
                    }
                };

                try {
                    // Create function with custom console
                    const AsyncFunction = Object.getPrototypeOf(async function(){}).constructor;
                    const fn = new AsyncFunction('console', 'puter', code);
                    await fn(customConsole, puter);
                } catch (error) {
                    customConsole.error(error.message);
                } finally {
                    setRunning(false);
                }
            };

            return (
                <div className="p-6 space-y-6">
                    <div className="glass-morphism rounded-xl p-6">
                        <div className="flex items-center justify-between mb-4">
                            <h2 className="text-2xl font-bold">Code Playground</h2>
                            <button
                                onClick={runCode}
                                disabled={running}
                                className="px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 transition-all"
                            >
                                {running ? 'Running...' : 'Run Code'}
                            </button>
                        </div>
                        
                        <div className="grid grid-cols-2 gap-4">
                            <div>
                                <h3 className="text-sm font-semibold text-gray-400 mb-2">Editor</h3>
                                <div ref={editorRef} className="monaco-container" />
                                {!monacoRef.current && (
                                    <textarea
                                        value={code}
                                        onChange={(e) => setCode(e.target.value)}
                                        className="w-full h-96 px-4 py-2 bg-gray-900 text-green-400 terminal-font text-sm rounded-lg"
                                    />
                                )}
                            </div>
                            
                            <div>
                                <h3 className="text-sm font-semibold text-gray-400 mb-2">Output</h3>
                                <pre className="h-96 px-4 py-2 bg-gray-900 text-green-400 terminal-font text-sm rounded-lg overflow-auto">
                                    {output || 'Output will appear here...'}
                                </pre>
                            </div>
                        </div>
                    </div>
                </div>
            );
        });

        // ============= ANALYTICS DASHBOARD =============
        const AnalyticsDashboard = memo(() => {
            const metrics = resourceManager.getMetrics();
            const chartRef = useRef(null);
            const chartInstance = useRef(null);

            useEffect(() => {
                if (!chartRef.current) return;

                if (chartInstance.current) {
                    chartInstance.current.destroy();
                }

                const ctx = chartRef.current.getContext('2d');
                chartInstance.current = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: Array.from({ length: 10 }, (_, i) => `T-${9-i}`),
                        datasets: [{
                            label: 'Response Time (ms)',
                            data: resourceManager.metrics.latencies.slice(-10),
                            borderColor: 'rgb(59, 130, 246)',
                            backgroundColor: 'rgba(59, 130, 246, 0.1)',
                            tension: 0.4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                grid: {
                                    color: 'rgba(255, 255, 255, 0.1)'
                                },
                                ticks: {
                                    color: 'rgba(255, 255, 255, 0.7)'
                                }
                            },
                            x: {
                                grid: {
                                    color: 'rgba(255, 255, 255, 0.1)'
                                },
                                ticks: {
                                    color: 'rgba(255, 255, 255, 0.7)'
                                }
                            }
                        }
                    }
                });

                return () => {
                    if (chartInstance.current) {
                        chartInstance.current.destroy();
                    }
                };
            }, [metrics]);

            return (
                <div className="p-6 space-y-6">
                    <div className="grid grid-cols-4 gap-4">
                        <div className="glass-morphism rounded-xl p-6">
                            <div className="text-3xl font-bold text-blue-400">
                                {metrics.totalRequests}
                            </div>
                            <div className="text-sm text-gray-400">Total Requests</div>
                        </div>
                        
                        <div className="glass-morphism rounded-xl p-6">
                            <div className="text-3xl font-bold text-green-400">
                                {metrics.avgLatency}ms
                            </div>
                            <div className="text-sm text-gray-400">Avg Response Time</div>
                        </div>
                        
                        <div className="glass-morphism rounded-xl p-6">
                            <div className="text-3xl font-bold text-purple-400">
                                {(metrics.cacheHitRate * 100).toFixed(1)}%
                            </div>
                            <div className="text-sm text-gray-400">Cache Hit Rate</div>
                        </div>
                        
                        <div className="glass-morphism rounded-xl p-6">
                            <div className="text-3xl font-bold text-red-400">
                                {(metrics.errorRate * 100).toFixed(1)}%
                            </div>
                            <div className="text-sm text-gray-400">Error Rate</div>
                        </div>
                    </div>

                    <div className="glass-morphism rounded-xl p-6">
                        <h3 className="text-xl font-bold mb-4">Response Time Trend</h3>
                        <div style={{ height: '300px' }}>
                            <canvas ref={chartRef}></canvas>
                        </div>
                    </div>

                    <div className="glass-morphism rounded-xl p-6">
                        <h3 className="text-xl font-bold mb-4">Provider Status</h3>
                        <div className="space-y-2">
                            {metrics.providerStatus.map(provider => (
                                <div key={provider.provider} className="flex items-center justify-between p-3 bg-gray-800 rounded-lg">
                                    <span className="font-medium">{provider.provider}</span>
                                    <div className="flex items-center gap-4">
                                        <span className="text-sm text-gray-400">
                                            Failures: {provider.failures}
                                        </span>
                                        <span className={`px-3 py-1 rounded-full text-xs font-bold ${
                                            provider.status === 'closed' ? 'bg-green-600' :
                                            provider.status === 'half-open' ? 'bg-yellow-600' :
                                            'bg-red-600'
                                        }`}>
                                            {provider.status.toUpperCase()}
                                        </span>
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>

                    <button
                        onClick={() => {
                            resourceManager.reset();
                            window.location.reload();
                        }}
                        className="px-6 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700"
                    >
                        Reset All Metrics
                    </button>
                </div>
            );
        });

        // ============= MAIN APPLICATION =============
        const App = () => {
            const [isSignedIn, setIsSignedIn] = useState(false);
            const [loading, setLoading] = useState(true);
            const [activeTab, setActiveTab] = useState('orchestrator');

            useEffect(() => {
                checkAuth();
            }, []);

            const checkAuth = async () => {
                try {
                    const signedIn = await puter.auth.isSignedIn();
                    setIsSignedIn(signedIn);
                } catch (error) {
                    console.error('Auth check failed:', error);
                } finally {
                    setLoading(false);
                }
            };

            const signIn = async () => {
                try {
                    await puter.auth.signIn();
                    setIsSignedIn(true);
                } catch (error) {
                    console.error('Sign in failed:', error);
                }
            };

            if (loading) {
                return (
                    <div className="min-h-screen flex items-center justify-center animated-gradient">
                        <div className="text-center">
                            <div className="text-6xl mb-4 float-animation">üöÄ</div>
                            <h1 className="text-4xl font-bold mb-2">Puter.js Developer Powerhouse</h1>
                            <p className="text-xl">Initializing 400+ AI Models...</p>
                        </div>
                    </div>
                );
            }

            if (!isSignedIn) {
                return (
                    <div className="min-h-screen flex items-center justify-center animated-gradient">
                        <div className="glass-morphism rounded-2xl p-12 max-w-2xl w-full neon-glow">
                            <h1 className="text-5xl font-bold mb-4 text-center">
                                Puter.js Developer Powerhouse
                            </h1>
                            <p className="text-xl text-center mb-8 text-gray-300">
                                400+ AI Models ‚Ä¢ Raw TCP Sockets ‚Ä¢ CORS-Free Networking
                            </p>
                            
                            <div className="grid grid-cols-3 gap-4 mb-8">
                                <div className="text-center">
                                    <div className="text-3xl mb-2">ü§ñ</div>
                                    <div className="text-sm">400+ Models</div>
                                </div>
                                <div className="text-center">
                                    <div className="text-3xl mb-2">üîå</div>
                                    <div className="text-sm">Raw Sockets</div>
                                </div>
                                <div className="text-center">
                                    <div className="text-3xl mb-2">üåê</div>
                                    <div className="text-sm">No CORS</div>
                                </div>
                            </div>
                            
                            <button
                                onClick={signIn}
                                className="w-full px-8 py-4 bg-gradient-to-r from-purple-600 to-blue-600 text-white text-xl font-bold rounded-xl hover:from-purple-700 hover:to-blue-700 transition-all transform hover:scale-105"
                            >
                                Launch Developer Mode
                            </button>
                            
                            <p className="text-xs text-center text-gray-400 mt-6">
                                No API keys ‚Ä¢ User Pays Model ‚Ä¢ Privacy First ‚Ä¢ Unlimited Power
                            </p>
                        </div>
                    </div>
                );
            }

            const tabs = [
                { id: 'orchestrator', label: 'AI Orchestrator', icon: 'ü§ñ' },
                { id: 'networking', label: 'Networking', icon: 'üåê' },
                { id: 'playground', label: 'Code Playground', icon: 'üíª' },
                { id: 'analytics', label: 'Analytics', icon: 'üìä' }
            ];

            return (
                <AppProvider>
                    <div className="min-h-screen flex flex-col">
                        {/* Header */}
                        <header className="bg-gray-800 border-b border-gray-700">
                            <div className="px-6 py-4">
                                <div className="flex items-center justify-between">
                                    <h1 className="text-2xl font-bold flex items-center gap-2">
                                        <span className="text-3xl">‚ö°</span>
                                        Puter.js Developer Powerhouse
                                    </h1>
                                    <div className="flex items-center gap-4">
                                        <span className="px-3 py-1 bg-green-600 rounded-full text-xs font-bold pulse-dot">
                                            LIVE
                                        </span>
                                        <button
                                            onClick={() => puter.auth.signOut()}
                                            className="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700"
                                        >
                                            Sign Out
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            {/* Tabs */}
                            <div className="flex px-6">
                                {tabs.map(tab => (
                                    <button
                                        key={tab.id}
                                        onClick={() => setActiveTab(tab.id)}
                                        className={`px-6 py-3 flex items-center gap-2 border-b-2 transition-all ${
                                            activeTab === tab.id
                                                ? 'border-blue-500 text-blue-400'
                                                : 'border-transparent text-gray-400 hover:text-gray-200'
                                        }`}
                                    >
                                        <span className="text-xl">{tab.icon}</span>
                                        <span>{tab.label}</span>
                                    </button>
                                ))}
                            </div>
                        </header>

                        {/* Content */}
                        <main className="flex-1 overflow-auto">
                            {activeTab === 'orchestrator' && <AIOrchestrator />}
                            {activeTab === 'networking' && <NetworkingPanel />}
                            {activeTab === 'playground' && <CodePlayground />}
                            {activeTab === 'analytics' && <AnalyticsDashboard />}
                        </main>
                    </div>
                </AppProvider>
            );
        };

        // Render
        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
